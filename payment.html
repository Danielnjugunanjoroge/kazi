<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Payment</title>
<link rel="stylesheet" href="styles1.css">

<style>
.payment-box {
    width: 80%;
    margin: auto;
    background: #fff;
    padding: 25px;
    border-radius: 8px;
    box-shadow: 0px 0px 8px #888;
}
.pay-option {
    border: 1px solid #bbb;
    padding: 15px;
    margin-top: 10px;
    border-radius: 6px;
}
.pay-option:hover {
    border-color: #007bff;
}
label {
    font-size: 17px;
}
input[type="text"], input[type="number"] {
    width: 95%;
    padding: 10px;
    margin-top: 6px;
    border-radius: 5px;
    border: 1px solid #aaa;
}
button {
    padding: 12px 15px;
    background: #007bff;
    border: none;
    color: #fff;
    border-radius: 6px;
    cursor: pointer;
}
button:hover {
    background: #0056b3;
}
</style>

</head>

<body>

<div class="payment-box">
    <h2>Checkout - Complete Payment</h2>

    <p>Total Amount: <b style="color:green;" id="totalAmount">Ksh 0</b></p>

    <hr><br>

    <label><input type="radio" name="method" value="mpesa"> Pay with M-Pesa</label>
    <div id="mpesaForm" class="pay-option" style="display:none;">
        <label>Enter Phone Number:</label>
        <input type="text" id="mpesaPhone" placeholder="0712 345 678">
    </div>

    <br>
    <label><input type="radio" name="method" value="card"> Pay with Credit/Debit Card</label>
    <div id="cardForm" class="pay-option" style="display:none;">

        <label>Card Holder Name:</label>
        <input type="text" id="cardName" placeholder="Full Name">

        <label>Card Number:</label>
        <input type="number" id="cardNumber" placeholder="Enter 16 digits">

        <label>Expiry Date:</label>
        <input type="text" id="expiry" placeholder="MM/YY">

        <label>CVV:</label>
        <input type="number" id="cvv" placeholder="3 digits">
    </div>

    <br><hr><br>

    <button onclick="completePayment()">Complete Payment</button>
</div>

<script>
// Display saved cart total
document.addEventListener("DOMContentLoaded", () => {
    let total = localStorage.getItem("cartTotal");
    if(total !== null){
        document.getElementById("totalAmount").innerHTML = "Ksh " + total;
    }
});

// Toggle sections
document.querySelectorAll('input[name="method"]').forEach(e => {
    e.addEventListener("change", () => {
        if(e.value == "mpesa"){
            mpesaForm.style.display = "block";
            cardForm.style.display = "none";
        } else {
            cardForm.style.display = "block";
            mpesaForm.style.display = "none";
        }
    });
});

function completePayment(){
    let method = document.querySelector('input[name="method"]:checked');

    if(!method){
        alert("Please select a payment method!");
        return;
    }

    if(method.value === "mpesa"){
        let phone = document.getElementById("mpesaPhone").value;
        if(phone.length < 10){
            alert("Enter a valid phone number!");
            return;
        }
        alert("M-Pesa prompt sent to " + phone + ".");
    }

    if(method.value === "card"){
        let card = document.getElementById("cardNumber").value;
        let cvv = document.getElementById("cvv").value;

        if(card.length < 16){
            alert("Invalid Card Number!");
            return;
        }
        if(cvv.length < 3){
            alert("Invalid CVV!");
            return;
        }

        alert("Card payment successful!");
    }

    // Clear cart after payment
    localStorage.removeItem("one_stop_cart");
    localStorage.removeItem("cartTotal");

    setTimeout(() => {
        window.location.href = "front.html";
    }, 1500);
}

</script>

</body>
</html>
