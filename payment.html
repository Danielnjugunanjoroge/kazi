<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Payment - ONE STOP</title>

  <style>
    :root{
      --dark:#111;
      --accent:#2E8B57;
      --accent-dark:#256b4a;
      --muted:#f4f6f8;
      --card:#fff;
    }

    body{
      font-family: Arial, Helvetica, sans-serif;
      background:var(--muted);
      margin:0;
    }

    header{
      background:var(--dark);
      color:#fff;
      padding:14px 18px;
    }

    nav a{
      color:#ccc;
      text-decoration:none;
      margin-right:14px;
    }

    nav a:hover{
      color:#fff;
    }

    main{
      max-width:600px;
      margin:30px auto;
      background:#fff;
      padding:20px;
      border-radius:8px;
      box-shadow:0 4px 10px rgba(0,0,0,0.06);
    }

    h2{
      color:var(--dark);
      margin-top:0;
    }

    .info-box{
      padding:12px;
      background:#f7f7f7;
      margin-bottom:16px;
      border-radius:6px;
    }

    select, button{
      width:100%;
      padding:10px;
      margin-top:12px;
      border-radius:6px;
      font-size:15px;
      border:1px solid #ddd;
    }

    button{
      background:var(--accent);
      color:white;
      border:0;
      font-weight:700;
      cursor:pointer;
    }

    button:hover{
      background:var(--accent-dark);
    }
  </style>
</head>

<body>
  <header>
    <nav>
      <a href="index.html">Home</a>
      <a href="product.html">Products</a>
      <a href="cart.html">Cart</a>
      <a href="payment.html">Payment</a>
    </nav>
  </header>

  <main>
    <h2>Payment Details</h2>

    <div class="info-box">
      <strong>Email:</strong> <span id="emailDisplay"></span><br>
      <strong>Total:</strong> Ksh <span id="totalDisplay"></span><br>
      <strong>Items:</strong> <span id="itemCount"></span><br>
      <strong>Date:</strong> <span id="dateDisplay"></span><br>
      <strong>Time:</strong> <span id="timeDisplay"></span><br>
      <strong>Transaction ID:</strong> <span id="txID"></span>
    </div>

    <label><strong>Select Payment Method:</strong></label>
    <select id="paymentMethod">
      <option value="">-- Choose Method --</option>
      <option value="M-Pesa">M-Pesa</option>
      <option value="Visa Card">Visa Card</option>
      <option value="Cash on Delivery">Cash on Delivery</option>
    </select>

    <button onclick="completePayment()">Complete Payment</button>
  </main>

  <script>
    // Load data saved from cart
    document.getElementById("emailDisplay").textContent = localStorage.getItem("checkout_email") || "Unknown";
    document.getElementById("totalDisplay").textContent = localStorage.getItem("checkout_total") || "0";

    // items count from cart
    const cart = JSON.parse(localStorage.getItem("one_stop_cart")) || [];
    document.getElementById("itemCount").textContent = cart.length;

    // Date + Time fallback if user skipped cart
    const date = new Date();
    const d = date.toLocaleDateString();
    const t = date.toLocaleTimeString();
    localStorage.setItem("checkout_date", d);
    localStorage.setItem("checkout_time", t);

    document.getElementById("dateDisplay").textContent = d;
    document.getElementById("timeDisplay").textContent = t;

    // Generate transaction ID
    const tx = "TX" + Math.floor(Math.random() * 99999999);
    localStorage.setItem("checkout_tx", tx);
    document.getElementById("txID").textContent = tx;

    function completePayment(){
      const method = document.getElementById("paymentMethod").value;

      if(method === ""){
        alert("Please select a payment method first");
        return;
      }

      // Store payment method
      localStorage.setItem("checkout_payment_method", method);

      // Store cart items for receipt
      localStorage.setItem("checkout_items", JSON.stringify(cart));

      // Redirect to receipt
      window.location.href = "receipt.html";
    }
  </script>

</body>
</html>
