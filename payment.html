<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Receipt - ONE STOP</title>

<style>
:root{
  --dark:#111;
  --accent:#2E8B57;
  --muted:#f4f6f8;
  --card:#ffffff;
  --danger:#c0392b;
}

body{
  margin:0;
  font-family: Arial, Helvetica, sans-serif;
  background:var(--muted);
  color:#222;
}

header{
  background:var(--dark);
  padding:12px 16px;
  color:#fff;
  text-align:center;
  font-size:1.2rem;
  font-weight:bold;
}

.container{
  max-width:650px;
  background:var(--card);
  margin:30px auto;
  padding:22px;
  border-radius:10px;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
}

h2{
  text-align:center;
  color:var(--accent);
}

.info{
  margin-bottom:15px;
  background:#f7faf7;
  padding:12px;
  border-radius:8px;
  line-height:1.6;
  font-size:0.95rem;
}

table{
  width:100%;
  border-collapse:collapse;
}

th, td{
  padding:10px;
  border-bottom:1px solid #eee;
}

th{
  text-align:left;
}

.item-img{
  width:50px;
  height:50px;
  border-radius:6px;
  object-fit:cover;
  margin-right:6px;
}

.item-cell{
  display:flex;
  align-items:center;
}

.total-box{
  margin-top:15px;
  font-size:1.2rem;
  font-weight:bold;
  text-align:right;
  color:var(--accent);
}

.btn-area{
  margin-top:20px;
  display:flex;
  justify-content:space-between;
}

button{
  padding:10px 16px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}

.print-btn{
  background:var(--accent);
  color:white;
}

.home-btn{
  background:var(--dark);
  color:white;
}

@media(max-width:600px){
  .btn-area{
    flex-direction:column;
    gap:10px;
  }
}
</style>
</head>

<body>
<header>ONE STOP RECEIPT</header>

<div class="container">
  <h2>Purchase Receipt</h2>

  <div class="info">
    <strong>Date:</strong> <span id="receiptDate"></span><br>
    <strong>User Email:</strong> <span id="userEmail"></span><br>
    <strong>Payment Method:</strong> <span id="method"></span><br>
    <strong>Transaction ID:</strong> <span id="transaction"></span>
  </div>

  <table>
    <thead>
      <tr>
        <th>Item</th>
        <th style="width:80px;">Price</th>
      </tr>
    </thead>
    <tbody id="receiptBody"></tbody>
  </table>

  <div class="total-box" id="receiptTotal"></div>

  <div class="btn-area">
    <button class="print-btn" onclick="window.print()">Print Receipt</button>
    <button class="home-btn" onclick="goHome()">Home</button>
  </div>
</div>

<script>
function loadReceipt(){
  const cart = JSON.parse(localStorage.getItem("one_stop_cart") || "[]");
  const payment = JSON.parse(localStorage.getItem("one_stop_payment") || "{}");

  const email = localStorage.getItem("one_stop_email") || "Not Provided";
  const savedTime = localStorage.getItem("one_stop_time") || new Date().toLocaleString();

  const body = document.getElementById("receiptBody");
  const totalEl = document.getElementById("receiptTotal");
  const methodEl = document.getElementById("method");
  const dateEl = document.getElementById("receiptDate");
  const emailEl = document.getElementById("userEmail");
  const trxEl = document.getElementById("transaction");

  body.innerHTML = "";
  let total = 0;

  cart.forEach(item=>{
    const price = Number(item.price) || 0;
    total += price;

    const row = document.createElement("tr");
    row.innerHTML = `
      <td class="item-cell"><img src="${item.image}" class="item-img"> ${item.name}</td>
      <td>Ksh ${price}</td>
    `;
    body.appendChild(row);
  });

  totalEl.textContent = "Total Paid: Ksh " + total;
  methodEl.textContent = payment.method || "N/A";
  emailEl.textContent = email;
  dateEl.textContent = savedTime;

  // Generate basic transaction ID
  trxEl.textContent = "TXN" + Math.floor(Math.random()*999999);
}

function goHome(){
  localStorage.removeItem("one_stop_cart");
  window.location.href = "index.html";
}

// LOAD RECEIPT
loadReceipt();
</script>

</body>
</html>
